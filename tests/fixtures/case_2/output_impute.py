import pandas as pd
import numpy as np


def output_2_groupby_rolling_mean_and_shift():
    df = pd.DataFrame(
        {
            "uid": {
                0: 1,
                1: 2,
                2: 3,
                3: 4,
                4: 5,
                5: 6,
                6: 7,
                7: 8,
                8: 9,
                9: 10,
                10: 11,
                11: 12,
                12: 13,
                13: 14,
                14: 15,
                15: 16,
            },
            "date": {
                0: pd.to_datetime("2019-12-31 00:00:00"),
                1: pd.to_datetime("2020-03-31 00:00:00"),
                2: pd.to_datetime("2020-03-31 00:00:00"),
                3: pd.to_datetime("2020-03-31 00:00:00"),
                4: pd.to_datetime("2020-03-31 00:00:00"),
                5: pd.to_datetime("2020-06-30 00:00:00"),
                6: pd.to_datetime("2020-06-30 00:00:00"),
                7: pd.to_datetime("2020-06-30 00:00:00"),
                8: pd.to_datetime("2020-09-30 00:00:00"),
                9: pd.to_datetime("2020-09-30 00:00:00"),
                10: pd.to_datetime("2020-09-30 00:00:00"),
                11: pd.to_datetime("2020-09-30 00:00:00"),
                12: pd.to_datetime("2020-12-31 00:00:00"),
                13: pd.to_datetime("2020-12-31 00:00:00"),
                14: pd.to_datetime("2020-12-31 00:00:00"),
                15: pd.to_datetime("2020-12-31 00:00:00"),
            },
            "id": {
                0: "A",
                1: "A",
                2: "B",
                3: "C",
                4: np.nan,
                5: "A",
                6: "E",
                7: "B",
                8: "A",
                9: "F",
                10: "B",
                11: "C",
                12: "A",
                13: "B",
                14: "C",
                15: "G",
            },
            "desc": {
                0: "this is A",
                1: "this is A",
                2: "this is B",
                3: "this is C",
                4: np.nan,
                5: "this is A",
                6: "this is E",
                7: "this is B",
                8: "this is A",
                9: "this is F",
                10: "this is B",
                11: "this is C",
                12: "this is A",
                13: "this is B",
                14: "this is C",
                15: "this is G",
            },
            "volume": {
                0: 1.0,
                1: 2.0,
                2: 4.0,
                3: 6.0,
                4: 8.0,
                5: np.nan,
                6: 3.0,
                7: 4.0,
                8: 2.0,
                9: 4.0,
                10: np.nan,
                11: 6.0,
                12: 2.0,
                13: 4.0,
                14: 6.0,
                15: 10.0,
            },
            "random": {
                0: 1.0,
                1: 1.0,
                2: 1.0,
                3: 1.0,
                4: 1.0,
                5: np.nan,
                6: 1.0,
                7: 1.0,
                8: 1.0,
                9: 1.0,
                10: np.nan,
                11: 1.0,
                12: 1.0,
                13: 1.0,
                14: 1.0,
                15: 1.0,
            },
            "value": {
                0: 5.0,
                1: 15.0,
                2: 20.0,
                3: 30.0,
                4: np.nan,
                5: 10.0,
                6: 17.0,
                7: 20.0,
                8: 15.0,
                9: 20.0,
                10: 20000000.0,
                11: 30.0,
                12: 12.0,
                13: 20.0,
                14: 30.0,
                15: 100.0,
            },
        }
    )
    return df


def output_2_groupby_expanding_mean_and_shift():
    df = pd.DataFrame(
        {
            "uid": {
                0: 1,
                1: 2,
                2: 3,
                3: 4,
                4: 5,
                5: 6,
                6: 7,
                7: 8,
                8: 9,
                9: 10,
                10: 11,
                11: 12,
                12: 13,
                13: 14,
                14: 15,
                15: 16,
            },
            "date": {
                0: pd.to_datetime("2019-12-31 00:00:00"),
                1: pd.to_datetime("2020-03-31 00:00:00"),
                2: pd.to_datetime("2020-03-31 00:00:00"),
                3: pd.to_datetime("2020-03-31 00:00:00"),
                4: pd.to_datetime("2020-03-31 00:00:00"),
                5: pd.to_datetime("2020-06-30 00:00:00"),
                6: pd.to_datetime("2020-06-30 00:00:00"),
                7: pd.to_datetime("2020-06-30 00:00:00"),
                8: pd.to_datetime("2020-09-30 00:00:00"),
                9: pd.to_datetime("2020-09-30 00:00:00"),
                10: pd.to_datetime("2020-09-30 00:00:00"),
                11: pd.to_datetime("2020-09-30 00:00:00"),
                12: pd.to_datetime("2020-12-31 00:00:00"),
                13: pd.to_datetime("2020-12-31 00:00:00"),
                14: pd.to_datetime("2020-12-31 00:00:00"),
                15: pd.to_datetime("2020-12-31 00:00:00"),
            },
            "id": {
                0: "A",
                1: "A",
                2: "B",
                3: "C",
                4: np.nan,
                5: "A",
                6: "E",
                7: "B",
                8: "A",
                9: "F",
                10: "B",
                11: "C",
                12: "A",
                13: "B",
                14: "C",
                15: "G",
            },
            "desc": {
                0: "this is A",
                1: "this is A",
                2: "this is B",
                3: "this is C",
                4: np.nan,
                5: "this is A",
                6: "this is E",
                7: "this is B",
                8: "this is A",
                9: "this is F",
                10: "this is B",
                11: "this is C",
                12: "this is A",
                13: "this is B",
                14: "this is C",
                15: "this is G",
            },
            "volume": {
                0: 1.0,
                1: 2.0,
                2: 4.0,
                3: 6.0,
                4: 8.0,
                5: np.nan,
                6: 3.0,
                7: 4.0,
                8: 2.0,
                9: 4.0,
                10: np.nan,
                11: 6.0,
                12: 2.0,
                13: 4.0,
                14: 6.0,
                15: 10.0,
            },
            "random": {
                0: 1.0,
                1: 1.0,
                2: 1.0,
                3: 1.0,
                4: 1.0,
                5: np.nan,
                6: 1.0,
                7: 1.0,
                8: 1.0,
                9: 1.0,
                10: np.nan,
                11: 1.0,
                12: 1.0,
                13: 1.0,
                14: 1.0,
                15: 1.0,
            },
            "value": {
                0: 5.0,
                1: 15.0,
                2: 20.0,
                3: 30.0,
                4: np.nan,
                5: 10.0,
                6: 17.0,
                7: 20.0,
                8: 10.0,
                9: 20.0,
                10: 20000000.0,
                11: 30.0,
                12: 12.0,
                13: 20.0,
                14: 30.0,
                15: 100.0,
            },
        }
    )
    return df


def output_2_groupby_bfill():
    df = pd.DataFrame(
        {
            "uid": {
                0: 1,
                1: 2,
                2: 3,
                3: 4,
                4: 5,
                5: 6,
                6: 7,
                7: 8,
                8: 9,
                9: 10,
                10: 11,
                11: 12,
                12: 13,
                13: 14,
                14: 15,
                15: 16,
            },
            "date": {
                0: pd.to_datetime("2019-12-31 00:00:00"),
                1: pd.to_datetime("2020-03-31 00:00:00"),
                2: pd.to_datetime("2020-03-31 00:00:00"),
                3: pd.to_datetime("2020-03-31 00:00:00"),
                4: pd.to_datetime("2020-03-31 00:00:00"),
                5: pd.to_datetime("2020-06-30 00:00:00"),
                6: pd.to_datetime("2020-06-30 00:00:00"),
                7: pd.to_datetime("2020-06-30 00:00:00"),
                8: pd.to_datetime("2020-09-30 00:00:00"),
                9: pd.to_datetime("2020-09-30 00:00:00"),
                10: pd.to_datetime("2020-09-30 00:00:00"),
                11: pd.to_datetime("2020-09-30 00:00:00"),
                12: pd.to_datetime("2020-12-31 00:00:00"),
                13: pd.to_datetime("2020-12-31 00:00:00"),
                14: pd.to_datetime("2020-12-31 00:00:00"),
                15: pd.to_datetime("2020-12-31 00:00:00"),
            },
            "id": {
                0: "A",
                1: "A",
                2: "B",
                3: "C",
                4: np.nan,
                5: "A",
                6: "E",
                7: "B",
                8: "A",
                9: "F",
                10: "B",
                11: "C",
                12: "A",
                13: "B",
                14: "C",
                15: "G",
            },
            "desc": {
                0: "this is A",
                1: "this is A",
                2: "this is B",
                3: "this is C",
                4: np.nan,
                5: "this is A",
                6: "this is E",
                7: "this is B",
                8: "this is A",
                9: "this is F",
                10: "this is B",
                11: "this is C",
                12: "this is A",
                13: "this is B",
                14: "this is C",
                15: "this is G",
            },
            "volume": {
                0: 1.0,
                1: 2.0,
                2: 4.0,
                3: 6.0,
                4: 8.0,
                5: np.nan,
                6: 3.0,
                7: 4.0,
                8: 2.0,
                9: 4.0,
                10: np.nan,
                11: 6.0,
                12: 2.0,
                13: 4.0,
                14: 6.0,
                15: 10.0,
            },
            "random": {
                0: 1.0,
                1: 1.0,
                2: 1.0,
                3: 1.0,
                4: 1.0,
                5: np.nan,
                6: 1.0,
                7: 1.0,
                8: 1.0,
                9: 1.0,
                10: np.nan,
                11: 1.0,
                12: 1.0,
                13: 1.0,
                14: 1.0,
                15: 1.0,
            },
            "value": {
                0: 5.0,
                1: 15.0,
                2: 20.0,
                3: 30.0,
                4: np.nan,
                5: 12.0,
                6: 17.0,
                7: 20.0,
                8: 12.0,
                9: 20.0,
                10: 20000000.0,
                11: 30.0,
                12: 12.0,
                13: 20.0,
                14: 30.0,
                15: 100.0,
            },
        }
    )
    return df


def output_2_groupby_ffill():
    df = pd.DataFrame(
        {
            "uid": {
                0: 1,
                1: 2,
                2: 3,
                3: 4,
                4: 5,
                5: 6,
                6: 7,
                7: 8,
                8: 9,
                9: 10,
                10: 11,
                11: 12,
                12: 13,
                13: 14,
                14: 15,
                15: 16,
            },
            "date": {
                0: pd.to_datetime("2019-12-31 00:00:00"),
                1: pd.to_datetime("2020-03-31 00:00:00"),
                2: pd.to_datetime("2020-03-31 00:00:00"),
                3: pd.to_datetime("2020-03-31 00:00:00"),
                4: pd.to_datetime("2020-03-31 00:00:00"),
                5: pd.to_datetime("2020-06-30 00:00:00"),
                6: pd.to_datetime("2020-06-30 00:00:00"),
                7: pd.to_datetime("2020-06-30 00:00:00"),
                8: pd.to_datetime("2020-09-30 00:00:00"),
                9: pd.to_datetime("2020-09-30 00:00:00"),
                10: pd.to_datetime("2020-09-30 00:00:00"),
                11: pd.to_datetime("2020-09-30 00:00:00"),
                12: pd.to_datetime("2020-12-31 00:00:00"),
                13: pd.to_datetime("2020-12-31 00:00:00"),
                14: pd.to_datetime("2020-12-31 00:00:00"),
                15: pd.to_datetime("2020-12-31 00:00:00"),
            },
            "id": {
                0: "A",
                1: "A",
                2: "B",
                3: "C",
                4: np.nan,
                5: "A",
                6: "E",
                7: "B",
                8: "A",
                9: "F",
                10: "B",
                11: "C",
                12: "A",
                13: "B",
                14: "C",
                15: "G",
            },
            "desc": {
                0: "this is A",
                1: "this is A",
                2: "this is B",
                3: "this is C",
                4: np.nan,
                5: "this is A",
                6: "this is E",
                7: "this is B",
                8: "this is A",
                9: "this is F",
                10: "this is B",
                11: "this is C",
                12: "this is A",
                13: "this is B",
                14: "this is C",
                15: "this is G",
            },
            "volume": {
                0: 1.0,
                1: 2.0,
                2: 4.0,
                3: 6.0,
                4: 8.0,
                5: np.nan,
                6: 3.0,
                7: 4.0,
                8: 2.0,
                9: 4.0,
                10: np.nan,
                11: 6.0,
                12: 2.0,
                13: 4.0,
                14: 6.0,
                15: 10.0,
            },
            "random": {
                0: 1.0,
                1: 1.0,
                2: 1.0,
                3: 1.0,
                4: 1.0,
                5: np.nan,
                6: 1.0,
                7: 1.0,
                8: 1.0,
                9: 1.0,
                10: np.nan,
                11: 1.0,
                12: 1.0,
                13: 1.0,
                14: 1.0,
                15: 1.0,
            },
            "value": {
                0: 5.0,
                1: 15.0,
                2: 20.0,
                3: 30.0,
                4: np.nan,
                5: 15.0,
                6: 17.0,
                7: 20.0,
                8: 15.0,
                9: 20.0,
                10: 20000000.0,
                11: 30.0,
                12: 12.0,
                13: 20.0,
                14: 30.0,
                15: 100.0,
            },
        }
    )
    return df


def output_2_fill_na_in_id_col():
    df = pd.DataFrame(
        {
            "uid": {
                0: 1,
                2: 2,
                3: 3,
                4: 4,
                5: 5,
                6: 6,
                7: 7,
                8: 8,
                9: 9,
                10: 10,
                11: 11,
                12: 12,
                13: 13,
                14: 14,
                15: 15,
                16: 16,
            },
            "date": {
                0: pd.to_datetime("2019-12-31 00:00:00"),
                2: pd.to_datetime("2020-03-31 00:00:00"),
                3: pd.to_datetime("2020-03-31 00:00:00"),
                4: pd.to_datetime("2020-03-31 00:00:00"),
                5: pd.to_datetime("2020-03-31 00:00:00"),
                6: pd.to_datetime("2020-06-30 00:00:00"),
                7: pd.to_datetime("2020-06-30 00:00:00"),
                8: pd.to_datetime("2020-06-30 00:00:00"),
                9: pd.to_datetime("2020-09-30 00:00:00"),
                10: pd.to_datetime("2020-09-30 00:00:00"),
                11: pd.to_datetime("2020-09-30 00:00:00"),
                12: pd.to_datetime("2020-09-30 00:00:00"),
                13: pd.to_datetime("2020-12-31 00:00:00"),
                14: pd.to_datetime("2020-12-31 00:00:00"),
                15: pd.to_datetime("2020-12-31 00:00:00"),
                16: pd.to_datetime("2020-12-31 00:00:00"),
            },
            "id": {
                0: "A",
                2: "A",
                3: "B",
                4: "C",
                5: "6a5fc77b9c7f4b3db0ef5943195adc1e",
                6: "A",
                7: "E",
                8: "B",
                9: "A",
                10: "F",
                11: "B",
                12: "C",
                13: "A",
                14: "B",
                15: "C",
                16: "G",
            },
            "desc": {
                0: "this is A",
                2: "this is A",
                3: "this is B",
                4: "this is C",
                5: np.nan,
                6: "this is A",
                7: "this is E",
                8: "this is B",
                9: "this is A",
                10: "this is F",
                11: "this is B",
                12: "this is C",
                13: "this is A",
                14: "this is B",
                15: "this is C",
                16: "this is G",
            },
            "value": {
                0: 5.0,
                2: 15.0,
                3: 20.0,
                4: 30.0,
                5: np.nan,
                6: np.nan,
                7: 17.0,
                8: 20.0,
                9: np.nan,
                10: 20.0,
                11: 20000000.0,
                12: 30.0,
                13: 12.0,
                14: 20.0,
                15: 30.0,
                16: 100.0,
            },
            "volume": {
                0: 1.0,
                2: 2.0,
                3: 4.0,
                4: 6.0,
                5: 8.0,
                6: np.nan,
                7: 3.0,
                8: 4.0,
                9: 2.0,
                10: 4.0,
                11: np.nan,
                12: 6.0,
                13: 2.0,
                14: 4.0,
                15: 6.0,
                16: 10.0,
            },
            "random": {
                0: 1.0,
                2: 1.0,
                3: 1.0,
                4: 1.0,
                5: 1.0,
                6: np.nan,
                7: 1.0,
                8: 1.0,
                9: 1.0,
                10: 1.0,
                11: np.nan,
                12: 1.0,
                13: 1.0,
                14: 1.0,
                15: 1.0,
                16: 1.0,
            },
        }
    )
    return df


def output_2_use_summary_stat_of_groupby_to_fill_na_mean():
    df = pd.DataFrame(
        {
            "uid": {
                0: 2,
                1: 3,
                2: 4,
                3: 5,
                4: 6,
                5: 7,
                6: 8,
                7: 9,
                8: 10,
                9: 11,
                10: 12,
                11: 13,
                12: 14,
                13: 15,
                14: 16,
            },
            "date": {
                0: pd.to_datetime("2020-03-31 00:00:00"),
                1: pd.to_datetime("2020-03-31 00:00:00"),
                2: pd.to_datetime("2020-03-31 00:00:00"),
                3: pd.to_datetime("2020-03-31 00:00:00"),
                4: pd.to_datetime("2020-06-30 00:00:00"),
                5: pd.to_datetime("2020-06-30 00:00:00"),
                6: pd.to_datetime("2020-06-30 00:00:00"),
                7: pd.to_datetime("2020-09-30 00:00:00"),
                8: pd.to_datetime("2020-09-30 00:00:00"),
                9: pd.to_datetime("2020-09-30 00:00:00"),
                10: pd.to_datetime("2020-09-30 00:00:00"),
                11: pd.to_datetime("2020-12-31 00:00:00"),
                12: pd.to_datetime("2020-12-31 00:00:00"),
                13: pd.to_datetime("2020-12-31 00:00:00"),
                14: pd.to_datetime("2020-12-31 00:00:00"),
            },
            "id": {
                0: "A",
                1: "B",
                2: "C",
                3: np.nan,
                4: "A",
                5: "E",
                6: "B",
                7: "A",
                8: "F",
                9: "B",
                10: "C",
                11: "A",
                12: "B",
                13: "C",
                14: "G",
            },
            "desc": {
                0: "this is A",
                1: "this is B",
                2: "this is C",
                3: np.nan,
                4: "this is A",
                5: "this is E",
                6: "this is B",
                7: "this is A",
                8: "this is F",
                9: "this is B",
                10: "this is C",
                11: "this is A",
                12: "this is B",
                13: "this is C",
                14: "this is G",
            },
            "volume": {
                0: 2.0,
                1: 4.0,
                2: 6.0,
                3: 8.0,
                4: np.nan,
                5: 3.0,
                6: 4.0,
                7: 2.0,
                8: 4.0,
                9: np.nan,
                10: 6.0,
                11: 2.0,
                12: 4.0,
                13: 6.0,
                14: 10.0,
            },
            "random": {
                0: 1.0,
                1: 1.0,
                2: 1.0,
                3: 1.0,
                4: np.nan,
                5: 1.0,
                6: 1.0,
                7: 1.0,
                8: 1.0,
                9: np.nan,
                10: 1.0,
                11: 1.0,
                12: 1.0,
                13: 1.0,
                14: 1.0,
            },
            "value": {
                0: 15.0,
                1: 20.0,
                2: 30.0,
                3: np.nan,
                4: 13.5,
                5: 17.0,
                6: 20.0,
                7: 13.5,
                8: 20.0,
                9: 20000000.0,
                10: 30.0,
                11: 12.0,
                12: 20.0,
                13: 30.0,
                14: 100.0,
            },
        }
    )
    return df
